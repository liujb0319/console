webpackJsonp([35],{"0wPW":function(a,t,e){var l=e("m0FO");"string"==typeof l&&(l=[[a.i,l,""]]),l.locals&&(a.exports=l.locals);e("XkoO")("bd1917ba",l,!0)},"3cXf":function(a,t,e){a.exports={default:e("I4CF"),__esModule:!0}},"5t7a":function(a,t,e){"use strict";function l(a){e("DWj+")}Object.defineProperty(t,"__esModule",{value:!0});var s=e("SmJL"),i=e("LmL1"),n=e("J0+h"),c=l,r=n(s.a,i.a,c,"data-v-63a1bfc4",null);t.default=r.exports},"6NfO":function(a,t,e){var l=e("f68a");l(l.S+l.F*!e("PRM/"),"Object",{defineProperty:e("Lohu").f})},"DWj+":function(a,t,e){var l=e("STL6");"string"==typeof l&&(l=[[a.i,l,""]]),l.locals&&(a.exports=l.locals);e("XkoO")("add882c4",l,!0)},I4CF:function(a,t,e){var l=e("0nnt"),s=l.JSON||(l.JSON={stringify:JSON.stringify});a.exports=function(a){return s.stringify.apply(s,arguments)}},LmL1:function(a,t,e){"use strict";var l=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:" font-color"},[e("div",{staticClass:"content-title"},[a._v(" 新建存储")]),a._v(" "),e("div",{staticClass:"content-container"},[e("div",{staticClass:"f12"},[a._v(" 依据指定的容量和权限，创建一个由管理员定义的存储请求")]),a._v(" "),e("el-form",{ref:"claim",staticClass:"mt20 limit-input ml-24",attrs:{model:a.claim,rules:a.rules,"label-width":"100px"}},[e("el-form-item",{staticClass:"red-star1 ml15",attrs:{label:"存储类型："}},[e("div",{staticClass:"inner-element"},[e("div",{staticClass:"f12 mt4"},[a._v("\n            由管理员定义，供用户选择的存储类型\n          ")]),a._v(" "),e("div",{staticClass:"bluewords ml20 f12"},[a._v("点击了解更多")])]),a._v(" "),e("div",{staticClass:"inner-element"},[e("div",[e("el-radio",{staticClass:"radio",attrs:{label:"ceph-storageclass-slow"},model:{value:a.claim.storageClass,callback:function(t){a.claim.storageClass=t},expression:"claim.storageClass"}},[a._v("类型一")])],1),a._v(" "),e("div",{staticClass:"ml20 f12"},[a._v("类型 | Zone : ceph-storageclass-slow")])]),a._v(" "),e("div",{staticClass:"inner-element"},[e("div",[e("el-radio",{staticClass:"radio",attrs:{label:"gfs-storageclass-slow"},model:{value:a.claim.storageClass,callback:function(t){a.claim.storageClass=t},expression:"claim.storageClass"}},[a._v("类型二")])],1),a._v(" "),e("div",{staticClass:"ml20 f12"},[a._v("类型 | Zone : gfs-storageclass-slow")])]),a._v(" "),e("div",{staticClass:"inner-element"},[e("div",[e("el-radio",{staticClass:"radio",attrs:{label:""},model:{value:a.claim.storageClass,callback:function(t){a.claim.storageClass=t},expression:"claim.storageClass"}},[a._v("无类型")])],1),a._v(" "),e("div",{staticClass:"ml10 f12"},[a._v("无存储类型，或者是由管理员定义的默认存储类型")])])]),a._v(" "),e("el-form-item",{staticClass:"red-star1 ml15",attrs:{label:"存储名称：",prop:"name"}},[e("div",{},[e("el-input",{staticClass:"search-input",attrs:{autofocus:""},model:{value:a.claim.name,callback:function(t){a.claim.name=t},expression:"claim.name"}}),a._v(" "),e("div",{staticClass:"f12 "},[a._v(" 给项目中存储请求一个唯一的名称")])],1)]),a._v(" "),e("el-form-item",{staticClass:"red-star1 ml20",attrs:{labelWidth:"120px",label:"存储访问模式："}},[e("div",{staticClass:"ml10"},[e("div",[e("el-radio",{staticClass:"radio",attrs:{label:"ReadWriteOnce"},model:{value:a.claim.accessModes,callback:function(t){a.claim.accessModes=t},expression:"claim.accessModes"}},[a._v("单用户（RWO)")]),a._v(" "),e("el-radio",{staticClass:"radio",attrs:{label:"ReadWriteMany"},model:{value:a.claim.accessModes,callback:function(t){a.claim.accessModes=t},expression:"claim.accessModes"}},[a._v("共享用户（RWX）")]),a._v(" "),e("el-radio",{staticClass:"radio",attrs:{label:"ReadOnlyMany"},model:{value:a.claim.accessModes,callback:function(t){a.claim.accessModes=t},expression:"claim.accessModes"}},[a._v("只读（ROX）")])],1),a._v(" "),e("div",{staticClass:"f12"},[a._v(" 给已挂载的卷设置权限")])])]),a._v(" "),e("el-form-item",{staticClass:"mt20 red-star1 ml15",attrs:{prop:"amount",label:"存储容量："}},[e("el-row",{attrs:{align:"middle"}},[e("el-col",{staticClass:"my-select"},[e("el-input",{staticClass:"search-input ",model:{value:a.claim.amount,callback:function(t){a.claim.amount=a._n(t)},expression:"claim.amount"}}),a._v(" "),e("el-select",{staticClass:"selectwh100 tr ml20",attrs:{filterable:"",placeholder:"请选择"},model:{value:a.claim.unit,callback:function(t){a.claim.unit=t},expression:"claim.unit"}},a._l(a.options,function(a,t){return e("el-option",{key:t,attrs:{label:a.label,value:a.value}})})),a._v(" "),e("div",{staticClass:"f12 "},[a._v(" 设置需要大小")])],1)],1)],1),a._v(" "),e("el-form-item",{staticClass:"ml-8",attrs:{label:"存储标签"}},[e("div",{staticClass:"inner-element"},[e("div",{staticClass:"ml10 f12"},[a._v("为你的存储键入标签的键值")]),a._v(" "),e("div",{staticClass:"bluewords ml20 f12"},[a._v("点击了解更多")])])]),a._v(" "),a._l(a.claim.entry,function(t,l){return t?e("el-form-item",{key:l,attrs:{prop:"label",label:"标签：",rules:[{validator:a.validatelabel}]}},[e("el-row",{staticClass:"inner-element "},[e("div",{staticClass:"wh350 ml10"},[e("el-input",{attrs:{value:"11",placeholder:"label"},model:{value:t.label,callback:function(a){t.label=a},expression:"item.label"}})],1),a._v(" "),e("div",{staticClass:"wh350 ml20 ",attrs:{prop:"value"}},[e("el-input",{attrs:{value:"22",placeholder:"value"},model:{value:t.value,callback:function(a){t.value=a},expression:"item.value"}})],1),a._v(" "),e("div",{staticClass:"pluse-default ml20",on:{click:function(t){a.addInput(l)}}},[a._v(" + ")]),a._v(" "),e("div",{staticClass:"delete-default ml20",on:{click:function(t){a.deleInput(l)}}},[a._v(" × ")]),a._v(" "),e("br"),a._v(" "),e("small",{directives:[{name:"show",rawName:"v-show",value:t.hasError,expression:"item.hasError"}],staticClass:"has-error"},[a._v("label不能为空")])])],1):a._e()}),a._v(" "),e("el-form-item",{staticClass:"btn110 mt40 "},[e("el-button",{attrs:{type:"primary"},on:{click:function(t){a.submitForm("claim")}}},[a._v("创建")]),a._v(" "),e("el-button",{on:{click:a.cancel}},[a._v("取消")])],1)],2)],1)])},s=[],i={render:l,staticRenderFns:s};t.a=i},NVSU:function(a,t,e){"use strict";function l(a){e("0wPW")}var s=e("il3b"),i=e("vDNy"),n=e("J0+h"),c=l,r=n(s.a,i.a,c,"data-v-74e13498",null);t.a=r.exports},STL6:function(a,t,e){t=a.exports=e("YfG4")(!1),t.push([a.i,".help-block[data-v-63a1bfc4]{color:#c00;margin-left:55px}.left[data-v-63a1bfc4]{width:160px;text-align:right;margin-right:10px}div[data-v-63a1bfc4]{color:#333}.ml50[data-v-63a1bfc4]{margin-left:50px}.has-error[data-v-63a1bfc4]{color:#ff4949}.wh1000[data-v-63a1bfc4]{width:1000px}.wh714[data-v-63a1bfc4]{width:714px}.ml26[data-v-63a1bfc4]{margin-left:26px}.ml55[data-v-63a1bfc4]{margin-left:55px}.ml-24[data-v-63a1bfc4]{margin-left:-24px}.ml-8[data-v-63a1bfc4]{margin-left:-8px}.flt[data-v-63a1bfc4]{float:left}",""])},SmJL:function(a,t,e){"use strict";var l=e("a3Yh"),s=e.n(l),i=e("3cXf"),n=e.n(i),c=e("4YfN"),r=e.n(c),o=e("lQSI"),m=e("NVSU");t.a={components:{Deleinput:m.a},props:{},created:function(){this.change(this.$route.path),this.getData()},ready:function(){},data:function(){return{claim:{storageClass:"",accessModes:"ReadWriteOnce",name:"",amount:"",unit:"Mi",entry:[{label:"",value:"",hasError:!1}]},options:[{value:"Mi",label:"MiB"},{value:"Gi",label:"GiB"},{value:"Ti",label:"TiB"},{value:"Pi",label:"PiB"}],metadata:"",rules:{name:[{validator:function(a,t,e){t=t.replace(/(^\s*)|(\s*$)/g,"");var l=/^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$/;if(!t)return e(new Error("存储名称不能为空"));l.test(t)?e():e(new Error("存储名称只能由小写字母、数字、句号和连字符组成。必须以字母或数字开头和结尾"))}}],amount:[{required:!0,message:" 存储容量不能为空"},{type:"number",message:"存储容量必须为数字值"}]},namespace:""}},methods:r()({},e.i(o.c)(["change"]),{foundStorage:function(){},addInput:function(){this.claim.entry.push({label:"",value:"",hasError:!1})},deleInput:function(a){this.claim.entry.length>1&&this.claim.entry.splice(a,1)},getData:function(){var a=this;this.namespace=this.$route.params.disName,this.$ajax({method:"get",url:this.$httpConfig.S_c.replace("{namespace}",this.namespace)}).then(function(t){t=JSON.parse(t.request.response),a.metadata=t.metadata}).catch(function(a){console.log("创建存储获取数据失败",a)})},creatStorage:function(){var a=this,t=n()(this.claim.entry);t=JSON.parse(t);var e={};for(var l in t)""==t[l].label&&""==t[l].value?e={}:e[t[l].label]=t[l].value;this.$ajax({method:"post",url:this.$httpConfig.S_list.replace("{namespace}",this.namespace),data:{metadata:s()({"volume.beta.kubernetes.io/storage-class":this.claim.storageClass,creationTimestamp:this.metadata.creationTimestamp,name:this.claim.name,resourceVersion:"35050128",uid:"6bccba12-a36b-11e7-97bc-0050568c7724",namespace:this.metadata.name},"resourceVersion",this.metadata.creationTimestamp),spec:{accessModes:[this.claim.accessModes],selector:{matchLabels:e},resources:{requests:{storage:this.claim.amount+this.claim.unit}}}}}).then(function(t){200==t.status||201==t.status?a.$router.push({name:"存储"}):a.open2()}).catch(function(a){console.log("创建存储失败",a)})},open2:function(){this.$confirm("存储名称已存在，请换一个！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){}).catch(function(){})},cancel:function(){this.$router.go(-1)},submitForm:function(a){var t=this;this.$refs[a].validate(function(a){if(console.log(111),console.log(-1==t.claim.entry.indexOf(!0)),!a||-1!=t.claim.entry.indexOf(!0))return console.log("error submit!!"),!1;t.creatStorage()})},validatelabel:function(a,t,e){for(var l=0;l<this.claim.entry.length;l++)""==this.claim.entry[l].label&&""!=this.claim.entry[l].value?this.claim.entry[l].hasError=!0:(this.claim.entry[l].hasError=!1,e())}}),computed:{},watch:{}}},a3Yh:function(a,t,e){"use strict";t.__esModule=!0;var l=e("liLe"),s=function(a){return a&&a.__esModule?a:{default:a}}(l);t.default=function(a,t,e){return t in a?(0,s.default)(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}},il3b:function(a,t,e){"use strict";t.a={props:{labe:String},created:function(){},ready:function(){},data:function(){return{form5:{labelKey2:"",labelValue2:""}}},components:{},filters:{},methods:{deleinput:function(){this.$emit("dele")},tianjia:function(){this.$emit("add")}},computed:{},watch:{}}},liLe:function(a,t,e){a.exports={default:e("uwuJ"),__esModule:!0}},m0FO:function(a,t,e){t=a.exports=e("YfG4")(!1),t.push([a.i,".dele-ding[data-v-74e13498]{width:70px}.el-input.el-input-small[data-v-74e13498],.el-select.el-select-small[data-v-74e13498]{width:300px}.ml26[data-v-74e13498]{margin-left:26px}.ml8[data-v-74e13498]{margin-left:5px}",""])},uwuJ:function(a,t,e){e("6NfO");var l=e("0nnt").Object;a.exports=function(a,t,e){return l.defineProperty(a,t,e)}},vDNy:function(a,t,e){"use strict";var l=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"mt10"},[e("el-form",{ref:"form",staticClass:"ml26",attrs:{model:a.form5}},["环境变量："===a.labe?e("el-form-item",{attrs:{label:"环境变量："}},[e("el-row",[e("el-col",{attrs:{span:7}},[e("el-input",{staticClass:"el-input-small",attrs:{placeholder:"PYTHON_HOST_IP"},model:{value:a.form5.labelKey2,callback:function(t){a.form5.labelKey2=t},expression:"form5.labelKey2"}})],1),a._v(" "),e("el-col",{attrs:{span:7}},[e("el-input",{staticClass:"el-input-small ml20",attrs:{placeholder:"192.168.1.1"},model:{value:a.form5.labelValue2,callback:function(t){a.form5.labelValue2=t},expression:"form5.labelValue2"}})],1),a._v(" "),e("el-col",{attrs:{span:3}},[e("el-col",{staticClass:"pluse-default ml40",attrs:{span:3}},[a._v(" + ")]),a._v(" "),e("el-col",{staticClass:"delete",attrs:{span:3}},[e("span",{staticClass:"ml20",on:{click:a.deleinput}},[a._v(" × ")])])],1)],1)],1):a._e(),a._v(" "),"标签："===a.labe?e("el-form-item",{attrs:{label:"标签："}},[e("el-row",{staticClass:"inner-element "},[e("div",{staticClass:"wh350 ml8"},[e("el-input",{attrs:{value:"",placeholder:"lable"}})],1),a._v(" "),e("div",{staticClass:"wh350 ml20"},[e("el-input",{attrs:{value:"",placeholder:"value"}})],1),a._v(" "),e("div",{staticClass:"pluse-default ml20",on:{click:a.tianjia}},[a._v(" + ")]),a._v(" "),e("div",{staticClass:"delete-default ml20",on:{click:a.deleinput}},[a._v(" × ")])])],1):a._e()],1)],1)},s=[],i={render:l,staticRenderFns:s};t.a=i}});