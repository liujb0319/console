webpackJsonp([55],{"3cXf":function(t,e,r){t.exports={default:r("I4CF"),__esModule:!0}},HbFG:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[t.$route.path!=t.localpath?r("div",[r("div",{staticClass:"content-title"},[t._v(" 报警管理")]),t._v(" "),r("el-row",{staticClass:"mt20"},[r("el-col",{attrs:{span:12}},[r("el-button",{attrs:{type:"primary"},on:{click:t.createAlarm}},[t._v(" 创建报警")]),t._v(" "),r("el-button",{staticClass:"shade-button ",on:{click:t.refreshTrigger}},[t._v("刷新")])],1),t._v(" "),r("el-col",{staticClass:"tr",attrs:{span:12}},[r("el-button",{attrs:{type:"primary"},on:{click:t.alarmGroupMag}},[t._v("报警组管理")])],1)],1),t._v(" "),r("div",{staticClass:"clearfix"}),t._v(" "),r("div",{staticClass:"content-container"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading2,expression:"loading2"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"数据加载中...",data:t.triggerList,stripe:""}},[r("el-table-column",{attrs:{prop:"name",label:"报警名称"}}),t._v(" "),r("el-table-column",{attrs:{prop:"service",label:"报警对象"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"hide"},[r("div",[t._v(t._s(e.row.service))])])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"level",label:"报警粒度",width:"150"}}),t._v(" "),r("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"hide"},[r("div",{class:e.row.enabled?"success-staus":"waitfor-status"},[t._v(t._s(e.row.enabled?"已启动":"已禁用"))])])]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"报警规则",width:"260"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",[t._v("\n                                "+t._s(e.row.rules.metricValue)+"\n                                "+t._s(e.row.rules.avgValue)+"\n                                "+t._s(e.row.rules.operatorValue)+"\n                                "+t._s(e.row.rules.threshold)+t._s(e.row.rules.unit)+"\n                            ")])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"notify",label:"通知对象"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"hide"},[r("div",[t._v(t._s(e.row.notify))])])]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{staticClass:"do",attrs:{type:"text",size:"small"},on:{click:function(r){t.handleSetting(e.row.settingData)}}},[t._v("修改")]),t._v(" "),r("el-button",{staticClass:"mid",attrs:{type:"text"}},[t._v(" |  ")]),t._v(" "),r("el-button",{staticClass:"do",attrs:{type:"text",size:"small"},on:{click:function(r){t.doHandle(e.row)}}},[t._v(t._s(e.row.enabled?"禁用":"启动"))]),t._v(" "),r("el-button",{staticClass:"mid",attrs:{type:"text"}},[t._v(" |  ")]),t._v(" "),r("el-button",{staticClass:"do",attrs:{type:"text",size:"small"},on:{click:function(r){t.delHandle(e.row,e.$index)}}},[t._v("删除")])]}}])})],1)],1)],1):t._e(),t._v(" "),r("router-view")],1)},i=[],o={render:a,staticRenderFns:i};e.a=o},I4CF:function(t,e,r){var a=r("0nnt"),i=a.JSON||(a.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},JF4t:function(t,e,r){e=t.exports=r("YfG4")(!1),e.push([t.i,'.ml115[data-v-8b907df6]{margin-left:115px}.wh350[data-v-8b907df6]{width:350px}.create .el-input[data-v-8b907df6]{width:400px}.el-select[data-v-8b907df6]{min-width:150px}.my-checkbox[data-v-8b907df6]{margin-left:-170px}.roules th[data-v-8b907df6]{text-align:left;border-bottom:1px solid #dedede;font-weight:400}.roules th[data-v-8b907df6]:last-child{border-bottom:none}.roules td[data-v-8b907df6]{text-align:left}.roules tr:nth-of-type(2) td[data-v-8b907df6]{padding-top:10px}.roules tr:nth-of-type(n+2) td[data-v-8b907df6]{padding-bottom:10px}.el-select[data-v-8b907df6]{min-width:80px}.col1[data-v-8b907df6]{width:300px}.col1 .el-select[data-v-8b907df6]:first-of-type{width:190px}.col1 .el-select[data-v-8b907df6]:nth-of-type(2){width:90px}.col2[data-v-8b907df6]{width:250px}.col2 .el-select[data-v-8b907df6]{width:100px}.col2 .el-input[data-v-8b907df6]{width:90px}.col80[data-v-8b907df6]{width:130px}.col80 .el-select[data-v-8b907df6]{width:90px}.col80 .el-input[data-v-8b907df6],.wh80[data-v-8b907df6]{width:80px}.wh820[data-v-8b907df6]{width:820px}.wh-all[data-v-8b907df6]{width:100%}.min-container[data-v-8b907df6]{border:1px solid #e5e5e5}.min-height[data-v-8b907df6]{min-height:40px;max-height:100px;overflow:auto;padding:0 10px}.min-top[data-v-8b907df6]{height:40px;line-height:40px;background-color:#eee}.warning-tip[data-v-8b907df6]{width:100px;padding-left:10px;height:30px;background-color:#ec6b6e;line-height:30px;border-radius:3px;color:#fff;position:relative}.warning-tip[data-v-8b907df6]:before{content:"";width:0;height:0;position:absolute;left:-10px;top:4px;border-top:12px solid transparent;border-right:15px solid #ec6b6e;border-bottom:12px solid transparent}.inner-error[data-v-8b907df6]{color:#ff4949}.hide[data-v-8b907df6]{width:90%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.hide[data-v-8b907df6]:hover{white-space:normal}.hide:hover>div[data-v-8b907df6]{display:block}.hide>div[data-v-8b907df6]{display:inline-block;padding-right:10px}',""])},JUol:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__=__webpack_require__("4YfN"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__=__webpack_require__("HzJ8"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify__=__webpack_require__("3cXf"),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_3_vuex__=__webpack_require__("lQSI");__webpack_exports__.a={props:{},created:function(){this.getTriggerList()},ready:function(){},data:function(){return{loading2:!0,triggerList:[]}},components:{},filters:{},methods:{alarmGroupMag:function(){this.$router.push({name:"报警组管理"})},createAlarm:function(){this.$router.push({name:"创建报警"})},handleSetting:function(t){window.localStorage.setItem("editTriger",BASE64.encoder(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default()(t))),this.$router.push({name:"创建报警"})},getTriggerList:function getTriggerList(){var _this=this;_this.loading2=!0,_this.triggerList=[],_this.$ajax({method:"get",url:_this.$httpConfig.hakular+"hawkular/alerts/triggers",headers:{Authorization:"Bearer "+_this.Token,"Hawkular-Tenant":_this.userName}}).then(function(res){if(console.log(res),_this.loading2=!1,200===res.status){console.log(res.data);var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _iterator=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default()(res.data),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var iterm=_step.value,objIterm={name:iterm.name,notify:JSON.parse(iterm.tags.SaveDataNotify).join(",")};objIterm.level="1"===iterm.tags.level?"应用级":"容器级",objIterm.service=iterm.description;var rule=eval("("+iterm.tags.SaveDatametric+")");objIterm.rules=rule,objIterm.enabled=iterm.enabled,objIterm.id=iterm.id,objIterm.settingData=iterm,_this.triggerList.push(objIterm)}}catch(t){_didIteratorError=!0,_iteratorError=t}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}})},refreshTrigger:function(){this.getTriggerList()},doHandle:function(t){var e=!t.enabled,r=this;r.$ajax({method:"put",url:r.$httpConfig.hakular+"hawkular/alerts/triggers/enabled?triggerIds="+t.id+"&enabled="+e,headers:{Authorization:"Bearer "+r.Token,"Hawkular-Tenant":r.userName}}).then(function(e){if(200===e.status){var a=t.enabled?"禁用":"启用";r.$message({message:"当前告警已"+a,type:"success"}),t.enabled=!t.enabled}console.log(e)})},delHandle:function(t,e){var r=this;this.$confirm("此操作将永久删除该告警规则, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.$ajax({method:"delete",url:r.$httpConfig.hakular+"hawkular/alerts/triggers/"+t.id,headers:{Authorization:"Bearer "+r.Token,"Hawkular-Tenant":r.userName}}).then(function(e){if(200===e.status)return r.$ajax({method:"put",url:r.$httpConfig.hakular+"hawkular/alerts/delete?triggerIds="+t.id,headers:{Authorization:"Bearer "+r.Token,"Hawkular-Tenant":r.userName}});throw new Error(e.data.ErrInfo)}).then(function(e){if(200===e.status)return r.$ajax({method:"put",url:r.$httpConfig.hakular+"hawkular/alerts/events/delete?triggerIds="+t.id,headers:{Authorization:"Bearer "+r.Token,"Hawkular-Tenant":r.userName}});throw new Error(e.data.ErrInfo)}).then(function(t){if(200!==t.status)throw new Error(t.data.ErrInfo);r.$message({message:"当前告警已删除",type:"success"}),r.triggerList.splice(e,1)}).catch(function(t){console.log(t),r.$alert(t,"删除告警失败",{confirmButtonText:"确定"})})})}},computed:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default()({},__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3_vuex__.b)(["localpath","Icons","Token","userName"])),watch:{}}},JwyP:function(t,e,r){"use strict";function a(t){r("mcvJ")}Object.defineProperty(e,"__esModule",{value:!0});var i=r("JUol"),o=r("HbFG"),n=r("J0+h"),l=a,s=n(i.a,o.a,l,"data-v-8b907df6",null);e.default=s.exports},mcvJ:function(t,e,r){var a=r("JF4t");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r("XkoO")("882a4c34",a,!0)}});