webpackJsonp([76],{"+NI5":function(t,a,e){a=t.exports=e("YfG4")(!1),a.push([t.i,"td[data-v-3ba52ba6],td div[data-v-3ba52ba6]{color:#333;font-size:12px}.t-table[data-v-3ba52ba6]{border:1px solid #e5e5e5}.t-table tr:first-of-type td[data-v-3ba52ba6]{padding:20px 0 0 20px}.t-table tr:nth-of-type(n+2) td[data-v-3ba52ba6]{padding:15px 0 0 20px}.t-table tr:last-of-type td[data-v-3ba52ba6]{padding:15px 0 20px 20px}.t-table tr td[data-v-3ba52ba6]:nth-child(2){border-left:1px solid #e5e5e5}.border-line[data-v-3ba52ba6]{border:1px solid #e5e5e5;padding:10px 20px 20px}.border-line>div[data-v-3ba52ba6]{margin-top:10px}.mirror-dever div[data-v-3ba52ba6]{color:#333;font-size:12px}.sudoBg[data-v-3ba52ba6]{display:inline-block;background-color:#def3ff;height:25px;line-height:25px}.envirenment div[data-v-3ba52ba6]:nth-of-type(n+2){margin-top:15px}",""])},"0s6f":function(t,a,e){"use strict";function o(t){e("Ikl5")}Object.defineProperty(a,"__esModule",{value:!0});var s=e("AaWk"),i=e("d+Zq"),n=e("J0+h"),r=o,d=n(s.a,i.a,r,"data-v-3ba52ba6",null);a.default=d.exports},AaWk:function(t,a,e){"use strict";var o=e("4YfN"),s=e.n(o),i=e("lQSI");a.a={props:{},created:function(){this.change(this.$route.path)},ready:function(){},data:function(){return{activeName:"first",loaded:!1,deleted:!1,modified:!1,imageStream:{},imageStreamTag:{},showData:{},labels:[],envirenments:[],layersData:[]}},beforeMount:function(){this.load()},components:{},filters:{},methods:s()({},e.i(i.c)(["change"]),{load:function(){var t=this;console.log("that.$route.query.imageName"),console.log(t.$route.query.imageName),this.$ajax.get(this.$httpConfig.image_detail.replace("{projectName}",t.$route.params.disName).replace("{imageName}",t.$route.query.imageName)).then(function(a){t.imageStream=a.data,t.$ajax.get(t.$httpConfig.imagestreamtags.replace("{projectName}",t.$route.params.disName).replace("{imageName}",t.$route.query.imageName).replace("{tag}",":"+t.$route.query.tag)).then(function(a){t.loaded=!0,t.imageStreamTag=a.data,t.setValueToPage(),t.$ajax.get(t.$httpConfig.images.replace("{projectName}",t.$route.params.disName)).then(function(a){t.updateByServer(a.data.metadata.selfLink,t.$token,a.data.metadata.resourceVersion)}).catch(function(t){console.log(t)})}).catch(function(t){console.log(t)})}).catch(function(t){console.log(t)})},setValueToPage:function(){var t=this.imageStreamTag;if(t){this.showData.pullCmd="$sudo docker pull register/"+t.metadata.name;var a=t.image.dockerImageMetadata.Config,e=a.Labels;this.showData.name=t.metadata.name,this.showData.imageName=e.name,this.showData.summary=e.summary,this.showData.description=e.description,this.showData.author=e.author?e.author:"未知",this.showData.built=this.timeago.format(e["build-date"],"zh_CN"),this.showData.digest=t.image.metadata.name,this.labels=this.getLabels(e),this.showData.annotations=this.getAnnotations(t.image.metadata.annotations),this.showData.dockerVersion=t.image.dockerImageMetadata.DockerVersion,this.showData.command=this.getCommand(a),this.showData.user=a.User,this.showData.workingDir=a.WorkingDir,this.showData.architecture=t.image.dockerImageMetadata.Architecture,this.showData.ports=this.getPorts(a),this.environments=this.getEnvironment(a),this.layersData=this.getLayers(t.image.dockerImageLayers)}},updateByServer:function(t,a,e){var o=this,s=this.$httpConfig.socketHost+t+"?access_token="+a+"&watch=true&resourceVersion="+e;console.log(s);var i=new WebSocket(s);i.onmessage=function(t){var a=JSON.parse(t.data);a.type&&"DELETED"===a.type?"ImageStream"===a.object.kind&&o.imageStream.metadata.name===a.object.metadata.name&&(o.deleted=!0):a.type&&"MODIFIED"===a.type&&"ImageStream"===a.object.kind&&o.imageStream.metadata.name===a.object.metadata.name&&(o.modified=!0)},i.onerror=function(t){console.log("[onerror]"),console.log(t)},i.onopen=function(t){console.log("[onopen]"),console.log(t)},i.onclose=function(){console.log("[onclose]")}},getAnnotations:function(t){var a="";for(var e in t)"annotations"!==e&&(a=a+e+":"+t[e]);return a},getLabels:function(t){var a=[];for(var e in t)"description"!==e&&a.push({value:e+"="+t[e]});return a},getCommand:function(t){var a=t.Cmd,e=t.Entrypoint,o="";if(a&&e)for(var s in e)e[s]&&a[s]&&(o=o+"$"+e[s]+" "+a[s]+"\n");return o},getPorts:function(t){var a=t.ExposedPorts,e="";if(a)for(var o in a)e+=o;return e},getEnvironment:function(t){var a=t.Env,e=[];if(a)for(var o in a)e.push({value:a[o]});return console.log(e),e},getLayers:function(t){var a=[];if(t)for(var e in t){var o={};o.name=t[e].name,t[e].size<1048576?o.size=t[e].size+"byte":o.size=(t[e].size/1048576).toFixed(1)+"MB",a.push(o)}return a.reverse()},handleClick:function(t,a){}}),computed:{},watch:{deleted:function(t){},modified:function(t){t&&this.load()}}}},Ikl5:function(t,a,e){var o=e("+NI5");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);e("XkoO")("24408988",o,!0)},"d+Zq":function(t,a,e){"use strict";var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.loaded?e("div",[t.deleted?e("el-alert",{attrs:{title:"警告",type:"warning",description:"此镜像已经被删除。","show-icon":""}}):t._e(),t._v(" "),e("div",{staticClass:"content-title"},[t._v(t._s(t.showData.name))]),t._v(" "),e("div",{staticClass:"content-container"},[e("div",{staticClass:"f12 "},[e("span",{staticClass:"color6"},[t._v("拉取镜像命令 ")]),t._v(" "),e("span",{staticClass:"ml10 color3 sudoBg"},[t._v(t._s(t.showData.pullCmd))])]),t._v(" "),e("div",{staticClass:"mt10"},[e("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"详情",name:"first"}},[e("div",[e("table",{staticClass:"t-table",attrs:{width:"100%",border:"0",cellspacing:"0",cellpadding:"0"}},[e("tr",[e("td",{attrs:{width:"160px"}},[t._v("镜像名称：")]),t._v(" "),e("td",[t._v(t._s(t.showData.imageName))])]),t._v(" "),e("tr",[e("td",[t._v("镜像介绍：")]),t._v(" "),e("td",[t._v(t._s(t.showData.summary))])]),t._v(" "),e("tr",[e("td",[t._v("镜像描述：")]),t._v(" "),e("td",[t._v(t._s(t.showData.description))])]),t._v(" "),e("tr",[e("td",[t._v("镜像作者：")]),t._v(" "),e("td",[t._v(t._s(t.showData.author))])]),t._v(" "),e("tr",[e("td",[t._v("创建时间：")]),t._v(" "),e("td",[t._v(t._s(t.showData.built))])]),t._v(" "),e("tr",[e("td",[t._v("数字标识符：")]),t._v(" "),e("td",[t._v(t._s(t.showData.digest))])]),t._v(" "),e("tr",{attrs:{valign:"top"}},[e("td",[t._v("标签：")]),t._v(" "),e("td",{staticClass:"envirenment"},t._l(t.labels,function(a,o){return e("div",[t._v("\n                          "+t._s(a.value)+"\n                        ")])}))]),t._v(" "),e("tr",[e("td",[t._v("注释：")]),t._v(" "),e("td",[t._v(t._s(t.showData.annotations))])]),t._v(" "),e("tr",[e("td",[t._v("Docker版本镜像：")]),t._v(" "),e("td",[t._v(t._s(t.showData.dockerVersion))])])])])]),t._v(" "),e("el-tab-pane",{attrs:{label:"配置",name:"second"}},[e("div",[e("table",{staticClass:"t-table",attrs:{width:"100%",border:"0",cellspacing:"0",cellpadding:"0"}},[e("tr",[e("td",{attrs:{width:"160px"}},[t._v("命令行：")]),t._v(" "),e("td",[t._v(t._s(t.showData.command))])]),t._v(" "),e("tr",[e("td",[t._v(t._s(t.showData.user))]),t._v(" "),e("td",[t._v("101")])]),t._v(" "),e("tr",[e("td",[t._v("目录：")]),t._v(" "),e("td",[t._v(t._s(t.showData.workingDir))])]),t._v(" "),e("tr",[e("td",[t._v("系统：")]),t._v(" "),e("td",[t._v(t._s(t.showData.architecture))])]),t._v(" "),e("tr",[e("td",[t._v("暴露端口：")]),t._v(" "),e("td",[t._v(t._s(t.showData.ports))])]),t._v(" "),e("tr",{attrs:{valign:"top"}},[e("td",[t._v("环境变量：")]),t._v(" "),e("td",{staticClass:"envirenment"},t._l(t.environments,function(a,o){return e("div",[t._v("\n                      "+t._s(a.value)+"\n                    ")])}))])])])]),t._v(" "),e("el-tab-pane",{staticClass:"mirror-de\nver",attrs:{label:"镜像分层",name:"third"}},[e("div",{staticClass:"border-line p20"},t._l(t.layersData,function(a,o){return e("el-row",[e("el-col",{attrs:{span:18}},[e("div",{staticClass:"f12 color3"},[t._v(t._s(a.name))])]),t._v(" "),e("el-col",{staticClass:"el-pagination",attrs:{span:6}},[e("div",{staticClass:"f12 color3"},[t._v(t._s(a.size))])])],1)}))])],1)],1)])],1):e("div",[t._m(0)])},s=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{"text-align":"center","line-height":"250px"}},[e("i",{staticClass:"el-icon-loading",staticStyle:{"font-size":"20px"}}),e("span",[t._v(" 加载中······")])])}],i={render:o,staticRenderFns:s};a.a=i}});